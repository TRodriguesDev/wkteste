unit uDAOItemPedido;

interface

uses
  FireDAC.Comp.Client, SysUtils, uControllerConn;

Type
  TDAOItemPedido = class
    private
    protected
    public
      function selecionar (MItemPedido : TMItemPedido) : TFDQuery;
      function incluir (MItemPedido : TMItemPedido) : Boolean;
      function excluir (MItemPedido : TMItemPedido) : Boolean;
      function alterar (MItemPedido : TMItemPedido) : Boolean;
  end;


implementation

{ TMItemPedidos }

function TDAOItemPedido.alterar(MItemPedido: TMItemPedido): Boolean;
begin
  //
end;

function TDAOItemPedido.excluir(MItemPedido: TMItemPedido): Boolean;
var
  qryItemPedido : TFDQuery;
begin
  qryItemPedido := TControllerConn.getInstance().daoConn.novaQuery;
  Try
    try
      qryItemPedido.ExecSQL('DELETE FROM itenspedido WHERE NUMPED_ITEM = :Codigo',[MItemPedido.NumPed_Item]);
      result := True;
    except
      result := False;
    end;
  Finally
    qryItemPedido.DisposeOf;
  End;
end;

function TDAOItemPedido.incluir(MItemPedido: TMItemPedido): Boolean;
var
  qryItemPedido : TFDQuery;
begin
  qryItemPedido := TControllerConn.getInstance().daoConn.novaQuery;
  Try
    try
      qryItemPedido.ExecSQL('INSERT INTO itenspedido (NUMPED_ITEM, CODPROD_ITEM, QTD_ITEM, VLUNIT_ITEM, VLTOT_ITEM)');
      qryItemPedido.ExecSQL('VALUES (:NUMPED_ITEM, :CODPROD_ITEM, :QTD_ITEM, :VLUNIT_ITEM, :VLTOT_ITEM)',[MItemPedido.NumPed_Item,MItemPedido.CodProd_Item,MItemPedido.QtdProd_Item,MItemPedido.VlUnit_Item,MItemPedido.Vltot_Item]);
      result := True;
    except
      result := False;
    end;
  Finally
    qryItemPedido.DisposeOf;
  End;
end;


function TDAOItemPedido.selecionar(MItemPedido : TMItemPedido): TFDQuery;
var
  qryItemPedido : TFDQuery;
begin
  qryItemPedido := TControllerConn.getInstance().daoConn.novaQuery;
  qryItemPedido.Open('SELECT * FROM itenspedido WHERE NUMPED_ITEM = ' + MItemPedido.NumPed_Item.ToString);
  Result := qryItemPedido;
end;

end.
